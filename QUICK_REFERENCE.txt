```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                     BERLIN-BENZ SECURITY IMPLEMENTATION                      â•‘
â•‘                         QUICK REFERENCE CARD                                 â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CORE PRINCIPLE: Backend is source of truth. Never trust frontend.            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ AUTHENTICATION (Auth Flow)                                                   â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                              â•‘
â•‘  User Input (email/password)                                                â•‘
â•‘        â†“                                                                     â•‘
â•‘  POST /api/auth/login                                                       â•‘
â•‘        â†“                                                                     â•‘
â•‘  Backend: bcrypt.compare(password, hash)                                    â•‘
â•‘        â†“                                                                     â•‘
â•‘  âœ… Valid â†’ req.session.userId = user.id                                     â•‘
â•‘  âŒ Invalid â†’ 401 Unauthorized (generic message)                             â•‘
â•‘        â†“                                                                     â•‘
â•‘  Browser gets httpOnly cookie                                               â•‘
â•‘  (JavaScript CANNOT read it)                                                â•‘
â•‘        â†“                                                                     â•‘
â•‘  Future requests: Cookie auto-sent                                          â•‘
â•‘  Backend: req.session.userId exists? âœ“ Access granted                       â•‘
â•‘                                                                              â•‘
â•‘  âœ… httpOnly = Immune to XSS                                                 â•‘
â•‘  âœ… Session = Verified server-side                                           â•‘
â•‘  âœ… No tokens = No bearer header attacks                                     â•‘
â•‘                                                                              â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ PAYMENT (Subscription Flow)                                                  â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                              â•‘
â•‘  Frontend:                      Backend:                 Stripe:            â•‘
â•‘  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€       â•‘
â•‘                                                                              â•‘
â•‘  1. User selects plan          (display)                                    â•‘
â•‘                                                                              â•‘
â•‘  2. POST /api/payment/          â†’ Lookup planId in config                   â•‘
â•‘     create-checkout             â†’ Get price from config: $98                â•‘
â•‘     { planId: "starter" }       â†’ Create Payment Intent: $98                â•‘
â•‘     (NO AMOUNT!)                â†’ Return clientSecret to frontend           â•‘
â•‘                                                                              â•‘
â•‘  3. Stripe.js handles card     (never touches our server)                   â•‘
â•‘  4. User enters card info      (goes directly to Stripe)                    â•‘
â•‘  5. Stripe processes payment   âœ… SUCCESS                                    â•‘
â•‘                                                                              â•‘
â•‘  6. [Webhook arrives]          â†’ Verify signature                           â•‘
â•‘                                 â†’ Verify amount = $98 âœ“                    â•‘
â•‘                                 â†’ Create subscription                       â•‘
â•‘                                 â†’ Audit log                                 â•‘
â•‘                                 â†’ User gets access                          â•‘
â•‘                                                                              â•‘
â•‘  âœ… Frontend cannot change price (backend enforces)                          â•‘
â•‘  âœ… Frontend cannot fake payment (webhook required)                          â•‘
â•‘  âœ… Backend verifies Stripe signature (cryptographic trust)                  â•‘
â•‘                                                                              â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ PDF PROTECTION (Access Control)                                             â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                              â•‘
â•‘  GET /api/articles/download/article.pdf                                     â•‘
â•‘        â†“                                                                     â•‘
â•‘  [1] Is user authenticated?                                                 â•‘
â•‘      â”œâ”€ No  â†’ 401 Unauthorized                                              â•‘
â•‘      â””â”€ Yes â†’ Continue                                                      â•‘
â•‘        â†“                                                                     â•‘
â•‘  [2] Does user have active subscription?                                    â•‘
â•‘      â”œâ”€ No  â†’ 403 Forbidden                                                 â•‘
â•‘      â””â”€ Yes â†’ Continue                                                      â•‘
â•‘        â†“                                                                     â•‘
â•‘  [3] Is filename in whitelist?                                              â•‘
â•‘      â”œâ”€ No  â†’ 404 Not Found                                                 â•‘
â•‘      â””â”€ Yes â†’ Continue                                                      â•‘
â•‘        â†“                                                                     â•‘
â•‘  [4] Does file path stay within /pdfs/?                                     â•‘
â•‘      â”œâ”€ No  â†’ 403 Forbidden (path traversal attempt)                        â•‘
â•‘      â””â”€ Yes â†’ Continue                                                      â•‘
â•‘        â†“                                                                     â•‘
â•‘  [5] Log access for audit trail                                             â•‘
â•‘        â†“                                                                     â•‘
â•‘  [6] Stream PDF with no-cache headers                                       â•‘
â•‘        â†“                                                                     â•‘
â•‘  âœ… User gets PDF                                                            â•‘
â•‘                                                                              â•‘
â•‘  âœ… Direct URL access: IMPOSSIBLE                                            â•‘
â•‘  âœ… Path traversal: BLOCKED                                                  â•‘
â•‘  âœ… No subscription: FORBIDDEN                                               â•‘
â•‘  âœ… Unwhitelisted file: NOT FOUND                                            â•‘
â•‘                                                                              â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ SECURITY DEFENSES (Layered)                                                 â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                              â•‘
â•‘  LAYER 1: Input Validation                                                  â•‘
â•‘  â”œâ”€ Email format check âœ“                                                    â•‘
â•‘  â”œâ”€ Password strength (12+ chars, complexity) âœ“                             â•‘
â•‘  â””â”€ Type checking on all inputs âœ“                                           â•‘
â•‘                                                                              â•‘
â•‘  LAYER 2: Authentication                                                    â•‘
â•‘  â”œâ”€ bcrypt password hashing âœ“                                               â•‘
â•‘  â”œâ”€ httpOnly session cookies âœ“                                              â•‘
â•‘  â””â”€ Server-side session validation âœ“                                        â•‘
â•‘                                                                              â•‘
â•‘  LAYER 3: Authorization                                                     â•‘
â•‘  â”œâ”€ Subscription verification âœ“                                             â•‘
â•‘  â”œâ”€ Endpoint-level access control âœ“                                         â•‘
â•‘  â””â”€ Whitelist-based file access âœ“                                           â•‘
â•‘                                                                              â•‘
â•‘  LAYER 4: Business Logic                                                    â•‘
â•‘  â”œâ”€ Backend-enforced pricing âœ“                                              â•‘
â•‘  â”œâ”€ Plans as source of truth âœ“                                              â•‘
â•‘  â””â”€ Webhook signature verification âœ“                                        â•‘
â•‘                                                                              â•‘
â•‘  LAYER 5: Rate Limiting & Headers                                           â•‘
â•‘  â”œâ”€ 5 auth attempts per 15 minutes âœ“                                        â•‘
â•‘  â”œâ”€ Helmet security headers âœ“                                               â•‘
â•‘  â”œâ”€ CORS by origin âœ“                                                        â•‘
â•‘  â””â”€ HSTS enforcement âœ“                                                      â•‘
â•‘                                                                              â•‘
â•‘  LAYER 6: Monitoring & Logging                                              â•‘
â•‘  â”œâ”€ Audit log all sensitive actions âœ“                                       â•‘
â•‘  â”œâ”€ Error tracking (ready for Sentry) âœ“                                     â•‘
â•‘  â””â”€ Suspicious pattern detection (ready) âœ“                                  â•‘
â•‘                                                                              â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ CRITICAL CODE LOCATIONS                                                      â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                              â•‘
â•‘  ğŸ” MOST IMPORTANT FILES:                                                    â•‘
â•‘                                                                              â•‘
â•‘  [1] backend/routes/webhooks.js (LINE 82-134)                               â•‘
â•‘      â””â”€ handlePaymentSucceeded()                                            â•‘
â•‘         â†³ ONLY place subscriptions are created                              â•‘
â•‘         â†³ Verifies Stripe signature + amount                                â•‘
â•‘         â†³ If you break this, revenue disappears                             â•‘
â•‘                                                                              â•‘
â•‘  [2] backend/config/plans.js                                                â•‘
â•‘      â””â”€ SUBSCRIPTION_PLANS object                                           â•‘
â•‘         â†³ Source of truth for pricing                                       â•‘
â•‘         â†³ If you change this, you change revenue                            â•‘
â•‘                                                                              â•‘
â•‘  [3] backend/routes/payment.js (LINE 48-60)                                 â•‘
â•‘      â””â”€ create-checkout endpoint                                            â•‘
â•‘         â†³ Backend calculates price from config                              â•‘
â•‘         â†³ Frontend amount is IGNORED                                        â•‘
â•‘                                                                              â•‘
â•‘  [4] backend/routes/articles.js (LINE 104-165)                              â•‘
â•‘      â””â”€ download endpoint                                                   â•‘
â•‘         â†³ Multiple validation layers                                        â•‘
â•‘         â†³ Whitelist prevents path traversal                                 â•‘
â•‘                                                                              â•‘
â•‘  [5] backend/middleware/auth.js                                             â•‘
â•‘      â””â”€ requireAuth, requireSubscription                                    â•‘
â•‘         â†³ Applied to every protected route                                  â•‘
â•‘                                                                              â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ TESTING CHECKLIST                                                            â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                              â•‘
â•‘  âœ… Auth                                                                     â•‘
â•‘     â–¡ Signup with weak password fails                                       â•‘
â•‘     â–¡ Login creates session cookie                                          â•‘
â•‘     â–¡ Logout destroys session                                               â•‘
â•‘     â–¡ API access without session returns 401                                â•‘
â•‘                                                                              â•‘
â•‘  âœ… Payment                                                                  â•‘
â•‘     â–¡ GET /plans returns backend prices                                     â•‘
â•‘     â–¡ POST /create-checkout ignores frontend amount                         â•‘
â•‘     â–¡ Stripe webhook creates subscription                                   â•‘
â•‘     â–¡ Payment status changes after webhook                                  â•‘
â•‘                                                                              â•‘
â•‘  âœ… Access Control                                                           â•‘
â•‘     â–¡ PDF download without subscription: 403                                â•‘
â•‘     â–¡ PDF download with subscription: 200                                   â•‘
â•‘     â–¡ Path traversal attempt: 403                                           â•‘
â•‘     â–¡ Unwhitelisted file: 404                                               â•‘
â•‘                                                                              â•‘
â•‘  âœ… Security                                                                 â•‘
â•‘     â–¡ Rate limiting (6th login attempt): 429                                â•‘
â•‘     â–¡ Webhook with wrong signature: 400                                     â•‘
â•‘     â–¡ Security headers present (curl -i)                                    â•‘
â•‘     â–¡ No stack traces in error responses                                    â•‘
â•‘                                                                              â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ NEVER DO THIS                                         (OR YOUR APP WILL DIE)â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                              â•‘
â•‘  âŒ Trust frontend for price                                                 â•‘
â•‘     Amount must come from backend config only                               â•‘
â•‘                                                                              â•‘
â•‘  âŒ Create subscription before webhook                                       â•‘
â•‘     Only handlePaymentSucceeded() creates subscriptions                     â•‘
â•‘                                                                              â•‘
â•‘  âŒ Skip webhook signature verification                                      â•‘
â•‘     Stripe signature is the only trusted proof                              â•‘
â•‘                                                                              â•‘
â•‘  âŒ Serve PDFs directly from /pdfs/                                          â•‘
â•‘     Must use /api/articles/download/ with auth checks                       â•‘
â•‘                                                                              â•‘
â•‘  âŒ Store secrets in code                                                    â•‘
â•‘     Everything in .env, never committed                                     â•‘
â•‘                                                                              â•‘
â•‘  âŒ Use localStorage for auth tokens                                         â•‘
â•‘     XSS steals it. Use httpOnly cookies only.                               â•‘
â•‘                                                                              â•‘
â•‘  âŒ Allow weak passwords                                                     â•‘
â•‘     12+ chars, uppercase, number, special char required                     â•‘
â•‘                                                                              â•‘
â•‘  âŒ Log passwords or tokens                                                  â•‘
â•‘     Audit log action, never the secret                                      â•‘
â•‘                                                                              â•‘
â•‘  âŒ Send detailed error messages to frontend                                 â•‘
â•‘     "Invalid email or password" - never expose which is wrong               â•‘
â•‘                                                                              â•‘
â•‘  âŒ Disable rate limiting in production                                      â•‘
â•‘     Protects against brute force and DoS                                    â•‘
â•‘                                                                              â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ ENVIRONMENT VARIABLES (Must Have)                                           â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                              â•‘
â•‘  SESSION_SECRET=<32+ random chars>     # httpOnly cookie encryption         â•‘
â•‘  JWT_SECRET=<32+ random chars>          # Legacy (remove later)             â•‘
â•‘  STRIPE_SECRET_KEY=sk_test_...          # Real Stripe key (test/live)      â•‘
â•‘  STRIPE_PUBLISHABLE_KEY=pk_test_...     # Frontend only key                â•‘
â•‘  STRIPE_WEBHOOK_SECRET=whsec_test_...   # Webhook signature verification   â•‘
â•‘  FRONTEND_URL=http://localhost:3000     # CORS origin                      â•‘
â•‘  DATABASE_URL=mongodb://...             # Database connection              â•‘
â•‘  NODE_ENV=production                    # Enable security features         â•‘
â•‘                                                                              â•‘
â•‘  Generate secrets: node -e "console.log(require('crypto').                 â•‘
â•‘                    randomBytes(32).toString('hex'))"                        â•‘
â•‘                                                                              â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ QUICK COMMANDS                                                               â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                              â•‘
â•‘  # Start backend                                                             â•‘
â•‘  $ cd backend && npm install && npm run dev                                 â•‘
â•‘                                                                              â•‘
â•‘  # Start frontend                                                            â•‘
â•‘  $ python -m http.server 3000                                               â•‘
â•‘                                                                              â•‘
â•‘  # Test signup                                                               â•‘
â•‘  $ curl -X POST http://localhost:5000/api/auth/signup \                     â•‘
â•‘    -H "Content-Type: application/json" \                                    â•‘
â•‘    -d '{"name":"Test","email":"test@ex.com",...}'                           â•‘
â•‘                                                                              â•‘
â•‘  # Test payment                                                              â•‘
â•‘  $ curl http://localhost:5000/api/payment/plans                             â•‘
â•‘                                                                              â•‘
â•‘  # Simulate Stripe webhook                                                   â•‘
â•‘  $ stripe listen --forward-to localhost:5000/webhooks/stripe                â•‘
â•‘  $ stripe trigger payment_intent.succeeded                                  â•‘
â•‘                                                                              â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ DOCUMENTATION                                                                â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                              â•‘
â•‘  ğŸ“„ DEVELOPER_REFERENCE.md ......... START HERE for quick reference         â•‘
â•‘  ğŸ“„ SECURITY_AUDIT.md ............. What was insecure (15 issues)          â•‘
â•‘  ğŸ“„ SECURITY_ARCHITECTURE.md ....... Deep dive on security design          â•‘
â•‘  ğŸ“„ PRODUCTION_SUMMARY.md .......... What changed & why                     â•‘
â•‘  ğŸ“„ DEPLOYMENT.md ................. How to deploy to production             â•‘
â•‘  ğŸ“„ PROJECT_STRUCTURE.md .......... File tree & changes summary            â•‘
â•‘                                                                              â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  ğŸ” SECURITY STATUS: âœ… PRODUCTION-READY
  
  This is a security-first, production-grade implementation.
  Backend is the single source of truth. Frontend cannot compromise security.
  Ready to handle real payments and real users.

```
